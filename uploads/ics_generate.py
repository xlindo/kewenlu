# coding: utf-8
import datetime
import icalendar
import pytz
import uuid

lst_rcfc_time = [
    "20240302193500;æˆéƒ½è“‰åŸ;é’å²›æµ·ç‰›;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20240310153000;æ²§å·é›„ç‹®;æˆéƒ½è“‰åŸ;æ²§å·ä½“è‚²åœº",
    "20240330190000;æˆéƒ½è“‰åŸ;å—é€šæ”¯äº‘;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20240406153000;å¤©æ´¥æ´¥é—¨è™;æˆéƒ½è“‰åŸ;å¤©æ´¥æ³°è¾¾è¶³çƒåœº",
    "20240410193500;æˆéƒ½è“‰åŸ;æµ™æ±Ÿä¿±ä¹éƒ¨;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20240414153000;é•¿æ˜¥äºšæ³°;æˆéƒ½è“‰åŸ;é•¿æ˜¥ä½“è‚²ä¸­å¿ƒä½“è‚²åœº",
    "20240420190000;æˆéƒ½è“‰åŸ;æ·±åœ³æ–°é¹åŸ;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20240426200000;æˆéƒ½è“‰åŸ;å±±ä¸œæ³°å±±;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20240501193500;æˆéƒ½è“‰åŸ;æ­¦æ±‰ä¸‰é•‡;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20240505193500;åŒ—äº¬å›½å®‰;æˆéƒ½è“‰åŸ;åŒ—äº¬å·¥äººä½“è‚²åœº",
    "20240510193500;æˆéƒ½è“‰åŸ;æ²³å—ä¿±ä¹éƒ¨;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20240517193500;æ¢…å·å®¢å®¶;æˆéƒ½è“‰åŸ;äº”åå¥¥ä½“ä¸­å¿ƒæƒ å ‚ä½“è‚²åœº",
    "20240522200000;ä¸Šæµ·æµ·æ¸¯;æˆéƒ½è“‰åŸ;ä¸Šæ±½æµ¦ä¸œè¶³çƒåœº",
    "20240526193500;æˆéƒ½è“‰åŸ;é’å²›è¥¿æµ·å²¸;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20240616193500;ä¸Šæµ·ç”³èŠ±;æˆéƒ½è“‰åŸ;ä¸Šæµ·ä½“è‚²åœº",
    "20240626193500;é’å²›æµ·ç‰›;æˆéƒ½è“‰åŸ;é’å²›é’æ˜¥è¶³çƒåœº",
    "20240630193500;æˆéƒ½è“‰åŸ;æ²§å·é›„ç‹®;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20240707190000;å—é€šæ”¯äº‘;æˆéƒ½è“‰åŸ;å¦‚çš‹å¥¥ä½“ä¸­å¿ƒä½“è‚²åœº",
    "20240712200000;æˆéƒ½è“‰åŸ;å¤©æ´¥æ´¥é—¨è™;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20240728193500;æµ™æ±Ÿä¿±ä¹éƒ¨;æˆéƒ½è“‰åŸ;æµ™æ±Ÿçœé»„é¾™ä½“è‚²ä¸­å¿ƒä½“è‚²åœº",
    "20240803200000;æˆéƒ½è“‰åŸ;é•¿æ˜¥äºšæ³°;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20240809193500;æ·±åœ³æ–°é¹åŸ;æˆéƒ½è“‰åŸ;æ·±åœ³å®å®‰ä½“è‚²ä¸­å¿ƒä½“è‚²åœº",
    "20240817200000;å±±ä¸œæ³°å±±;æˆéƒ½è“‰åŸ;æµå—å¥¥ä½“ä¸­å¿ƒä½“è‚²åœº",
    "20240825200000;æ­¦æ±‰ä¸‰é•‡;æˆéƒ½è“‰åŸ;æ­¦æ±‰ä½“è‚²ä¸­å¿ƒä½“è‚²",
    "20240914193500;æˆéƒ½è“‰åŸ;åŒ—äº¬å›½å®‰;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20240921193500;æ²³å—ä¿±ä¹éƒ¨;æˆéƒ½è“‰åŸ;éƒ‘å·èˆªæµ·ä½“è‚²åœº",
    "20240429193500;æˆéƒ½è“‰åŸ;æ¢…å·å®¢å®¶;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20241018200000;æˆéƒ½è“‰åŸ;ä¸Šæµ·æµ·æ¸¯;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
    "20241027153000;é’å²›è¥¿æµ·å²¸;æˆéƒ½è“‰åŸ;é’å²›è¥¿æµ·å²¸å¤§å­¦åŸä½“è‚²åœº",
    "20241102153000;ä¸Šæµ·ç”³èŠ±;æˆéƒ½è“‰åŸ;å‡¤å‡°å±±ä½“è‚²å…¬å›­ä¸“ä¸šè¶³çƒåœº:geo:30.769397,104.076049",
]


def create_event(summary, location, description, dtstart, dtend):
    event = icalendar.Event()
    event.add("summary", summary)

    event.add("dtstart", dtstart)
    event.add("dtend", dtend)
    # åˆ›å»ºæ—¶é—´
    # event.add('dtstamp', dt_now)
    event.add("location", location)
    event.add("description", description)

    # uidä¿è¯å”¯ä¸€
    event["uid"] = str(uuid.uuid1()) + "/douyin:chuanzu"

    return event


if __name__ == "__main__":
    cal = icalendar.Calendar()
    cal.add("version", "2.0")
    cal.add("X-APPLE-CALENDAR-COLOR", "#FF0000")
    cal.add("X-WR-CALNAME", "å››å·çƒé˜Ÿèµ›ç¨‹-æŠ–éŸ³â€œçœ‹çƒå»äº†â€")
    cal.add("X-WR-TIMEZONE", "Asia/Shanghai")

    # æˆéƒ½è“‰åŸ 2024
    for match in lst_rcfc_time:
        lst_match_info = match.split(";")
        summary = lst_match_info[1]
        if summary == "æˆéƒ½è“‰åŸ":
            summary = "âš½ã€ä¸»åœº/ä¸­è¶…2024ã€‘" + lst_match_info[1] + "v.s." + lst_match_info[2]
        else:
            summary = "ã€å®¢åœº/ä¸­è¶…2024ã€‘" + lst_match_info[1] + "v.s." + lst_match_info[2]
        description = "ğŸ’›æŠ–éŸ³ã€çœ‹çƒå»äº†ã€‘å’Œä½ ä¸€èµ·â€œé›„èµ·â€ï¼â¤ï¸"
        location = lst_match_info[3]
        dtstart = pytz.timezone("Asia/Shanghai").localize(
            datetime.datetime.strptime(lst_match_info[0], "%Y%m%d%H%M%S")
        )
        dtend = dtstart + datetime.timedelta(hours=2)
        cal.add_component(create_event(summary, location, description, dtstart, dtend))

    with open("chuanzu.ics", "wb") as f:
        f.write(cal.to_ical())
